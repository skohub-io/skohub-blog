{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023-02-09-tests-updated/","result":{"data":{"site":{"siteMetadata":{"title":"Skohub Blog"}},"markdownRemark":{"id":"a9ca1438-2e05-5355-8e06-72fe48377acc","excerpt":"For quite some time we have been adding new features to SkoHub Vocabs like switching languages, display of all relevant properties on the concept page and…","html":"<p>For quite some time we have been adding new features to SkoHub Vocabs like <a href=\"https://github.com/skohub-io/skohub-vocabs/issues/79\">switching languages</a>, display of all relevant properties on the concept page and <a href=\"https://github.com/skohub-io/skohub-vocabs/issues/159\">support for <code class=\"language-text\">skos:Collection</code></a>. Unfortunately there were no tests added to actually test these new functionalities. This led to some surprises now and then, for example when we noticed that at one point language tags did not show up when visiting a Collection page directly.</p>\n<p>Originally SkoHub Vocabs already contained some tests, so being the maintainer of SkoHub Vocabs I decided to follow up on that and got myself a little bit more familiar on the topic. Quickly I stumbled over the topic of <a href=\"https://en.wikipedia.org/wiki/Test-driven_development\">Test Driven Development</a> (TDD) and though I heard of it before, I decided to dive a little deeper and check, if that pattern might be appropriate for SkoHub Vocabs and the other SkoHub modules (and maybe my coding approaches in general).</p>\n<p>The general idea of TDD is as follows (borrowed heavily from the Wikipedia article):</p>\n<ul>\n<li>Requirements of a new feature are first translated into test cases</li>\n<li>Tests are written</li>\n<li>Code is written</li>\n</ul>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bb776e8e9127b9f8b7db84ec085e8e24/c8551/TDD_Global_Lifecycle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.86075949367089%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACoElEQVQoz1WTW2sbRxiG9et6mdtelPaq975Of0HvixrZVWklDIGaksSFthCFONiWoSSpE1zr4Oiwc9hdaVe7lnajg3dnnzKT+qIDDx/zzcsL32FqWuszpdQHKWVPCNG3SCkdSqm+1trFe+7v99qpJ/6Xr2mtY6UUNzc3DIdDRqORYzAYIIRAa419v8fePc9z+vF4jBh9QP2n00phDX0pJbdJUmKMoapMaYxZZblRShmttPF14NBaG6mkSdPUlIUxd8aYqzQ3Ok6Mr5TT1zwhg/w25amIzXd9zcZUFOs1bDds1huE9BhPe0ymA4ScslzmlCXstor3achnv7/miYgpPmZ4QlITSgVQ8fNAm69eXLIoDIQhgZqxLNbo8B9G3iVj8Q5PX7ErE/LiBqpbsruCw1HAdZpjj/Z9amEYBnfbLcUiNRGQ73Zks4gvO5d8+27IZpUipY9SPsliyTD+gT+uH6DyIcPZirLYObM7UxFFEbXA94Msy9hd/GWWf75guytZlxX7vQHdKGOVJAgpkFIQzRek2x59+YhloijKikG64utX7zmfpaziiJqcesEGiB/9aPoPPmej+uQmADKoKnzfdxP8FBW7nbEdYi19zGTCTz3JFydXyGVG6GtqUspgHseYRWK4HkC5pWTjygjDGZPJxGFXZDqdOtP15iO5HRxwLGN+FTF2sHbNXA//fvuWw8ePzS/Hz3h58orjZ7/RarXodDpMJxO3n3YvreHZ2RntVoujoyNenpxw/PQJh+023W6XMAw/Gb5+84Zms2kOGg2+r9dpNBocHBzw/HnHiWy5ltlsxvn5uXvb39+nXq+72Gw2OT09dZqaUiqwwiiKzH2/LPP5nCRJnKElCAKHzdlp2l9j892LC9qHbR5+85C9vT3+Bb6OWOgwZKY/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Test-Driven-Development Cycle\"\n        title=\"Test-Driven-Development Cycle\"\n        src=\"/static/bb776e8e9127b9f8b7db84ec085e8e24/f058b/TDD_Global_Lifecycle.png\"\n        srcset=\"/static/bb776e8e9127b9f8b7db84ec085e8e24/c26ae/TDD_Global_Lifecycle.png 158w,\n/static/bb776e8e9127b9f8b7db84ec085e8e24/6bdcf/TDD_Global_Lifecycle.png 315w,\n/static/bb776e8e9127b9f8b7db84ec085e8e24/f058b/TDD_Global_Lifecycle.png 630w,\n/static/bb776e8e9127b9f8b7db84ec085e8e24/40601/TDD_Global_Lifecycle.png 945w,\n/static/bb776e8e9127b9f8b7db84ec085e8e24/78612/TDD_Global_Lifecycle.png 1260w,\n/static/bb776e8e9127b9f8b7db84ec085e8e24/c8551/TDD_Global_Lifecycle.png 2814w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Test-Driven-Development Cycle</figcaption>\n  </figure></p>\n<p>This leads to the following development cycle:</p>\n<ol>\n<li>\n<p><strong>Write tests</strong>: This ensures that the developer actually understands the user requirements. Usually this is done with the help of use cases and user stories.</p>\n</li>\n<li>\n<p><strong>Run tests</strong>: The tests should now fail. If not, it might be the case that the actual feature is already present in the code and no further code needs to be written. Maybe documentation has to be updated accordingly.</p>\n</li>\n<li>\n<p><strong>Write the simplest code that passes the new tests</strong>: The code can (and should) later be refactored, so it can be ugly at this point.</p>\n</li>\n<li>\n<p><strong>All tests should now pass</strong>: If the code is still failing it should be revised till all tests pass.</p>\n</li>\n<li>\n<p><strong>Refactor as needed</strong>: Your tests now verify that the new feature is working as expected. If any tests during refactoring fail, you now can and will immediately correct your code.</p>\n</li>\n</ol>\n<h2>Consequences on SkoHub development</h2>\n<p>This approach has some consequences for the development of SkoHub modules.\nThese changes will also be reflected in the <a href=\"https://github.com/skohub-io/skohub-vocabs/issues/242\">yet to be published CONTRIBUTING.md</a>.\nIssues for new features should contain use cases and user stories as well as some notes that indicate when the feature is actually correctly implemented.\nJust when all of this is present, the issue can be marked as ready.\nThe use cases and notes can then be used to write the tests and follow the above mentioned development cycle.</p>\n<p>Regarding code review, this approach also has some consequences. Code review should only be approved if tests were added for the new feature or the tests were adjusted in case of bug fixing.</p>\n<h2>Testing Strategies and Technologies in SkoHub Vocabs</h2>\n<p>At the end of this blog post I want to give you a short overview of currently used testing strategies and technologies used in SkoHub Vocabs development. We use <strong>unit tests</strong>, <strong>integration tests</strong> and <strong>end-to-end tests</strong> whereby we try to write more unit tests than integration tests than end-to-end tests. The reason for this is that end-to-end tests take long and are quite expensive regarding computing power and time. Unit and integration tests on the other hand are cheap and can also auto-run in the background on every save, thus giving you immediate feedback when something is broken.</p>\n<p>For unit and integration tests we use <a href=\"https://jestjs.io/\">Jest</a> and the <a href=\"https://testing-library.com/docs/react-testing-library/intro\">React-Testing-Library</a> since Gatsby – with which SkoHub Vocabs is built – uses React.\nSome of the older tests used <a href=\"https://enzymejs.github.io/enzyme/\">Enzyme</a>, but after upgrading to React 18 I noticed that Enzyme was no longer working, because <a href=\"https://dev.to/wojtekmaj/enzyme-is-dead-now-what-ekl\">the project is dead</a>.\nAfter some research I found the React-Testing-Library as the most recommended testing framework and migrated the old Enzyme tests.\nAfter some initial training, writing tests became actually quite handy and fun.</p>\n<p>Adding tests is by no way finished at this point, but a lot of the lately added features now have some proper testing. This already required a few changes to the code base from now and then when I noticed things weren’t working as expected.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a0ad657099e495b1977b78ba0e9879f4/3f3b9/test_coverage.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 79.74683544303798%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACj0lEQVQ4y21U13LbMBDkd7hQoggSANHZJbmoOLE9cezEk///lc3gKI9K8nBzHJBY7N4umDhdo8gFipxT54WErhziulEeztQItoFWDlaFqetAVYcWwTXwtqZeMomk6QOsNwS4mBUEKoVCOwY476GUxnjXopIK/bqG1haVUmiHSKQiAhEodpaVSEJvsdrVsEGD5SXyrERZSCy3AaH1qEyF/fsSnEvcP7cw1kAqgfunDqrkmKU5shnD/NAT1xjs30dsf46wtSbAfM4ReoNuWaMoODavA/KMo7/3cMFCKon1toPmAot5cVaJ8Rr7jxHrfUsfspwTYD1YdKuaTn14HsAWETCcARohkGcXgMTwY0S78pCVRMHiqRNgv6oxT/8PuNq2NLNZyjC7ZUhvGT0nvjX49rlCM7pphovyyPAg+fFloFGcMdx1GIOCVwK2EnBKoOJ8Yvj42iP2gpVHyb0hhiR506C4YHi37zB4Ba8FgpZUWnAkJmjsf41YP7VwjUZZHCRHwHWN9DrHw3NPsTo1JUq+ucpxfZXj9iY/kdxZbN8GLDc1hBDI0uJMchxDlLeYlRguTHFSIhgJWXJSQqbEjbv3ETGPylbQVh9jczDl/nsPll2aEnMoYKQAZ+UpoMPznzU2PwZs3gb060CbyeV1g/Rmkjy5fC45vYkO53ToYs6mYPs+xmbAuAnk6OyaIUtLuFYRwxiJ6HK8khNDh+ogOY7hn2C3TY+u69C2HXxjKI/eBzShg3c1xUWKivIZDeNlRQbRWs6J+bFKJL8/PrF73KHiGsu7DtuXFaw19IephME8SrrNkaWMpMU7+9WjxMtKNpsn1HUPWTk0zRLe9ZjPS2QLTiGP2SwYP+lTxXdfRpxK/gupYeYBEmn59gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Test Coverage in SkoHub Vocabs\"\n        title=\"Current test coverage in SkoHub Vocabs\"\n        src=\"/static/a0ad657099e495b1977b78ba0e9879f4/f058b/test_coverage.png\"\n        srcset=\"/static/a0ad657099e495b1977b78ba0e9879f4/c26ae/test_coverage.png 158w,\n/static/a0ad657099e495b1977b78ba0e9879f4/6bdcf/test_coverage.png 315w,\n/static/a0ad657099e495b1977b78ba0e9879f4/f058b/test_coverage.png 630w,\n/static/a0ad657099e495b1977b78ba0e9879f4/3f3b9/test_coverage.png 870w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Current test coverage in SkoHub Vocabs</figcaption>\n  </figure></p>\n<p>For end-to-end tests I decided to go with <a href=\"https://www.cypress.io/\">cypress</a> since it has an excellent documentation, is fully open source and runs tests in a real browser.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/058d6/cypress.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.278481012658226%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWklEQVQY04WRy07CUBRF+QAf8RG11pZSsICKiGgc6C9oSFBnOjD6hU408Recmgg+iBoTQ6VYKHLb3i5TiI+ZO1nJGa1k75NIW1toRgkjs0Emu4Wqr/6gp0pMTGfYPzyj05M8vdk0HZcgkIThEN8PESKkL3xabY+EtbSNubiJbpXJrexgpMtoRhHNWCNprjM1Y1E9OMX56NNst+h4HkIIXu0mL3YTKSVRFBGn5XRJzGsFBpirGPkyWqqAouWZVSwUNcfI6Dx7lSM63YC2+4HwfT77fey2Q0+Igehb6MTCuFosVM0iyWwJPRXXXWZGWRwKx1R2K0e43QAR+IRRhB8GBGGIBAIpB0gi3p3OH2FmDWNpA80soOh55tQcippnZGyBvcoxPU/yXzz381e4kC6Rym6STJdRk8OnxFuOT5pUqyc0bJfz2g2X9zUu7m4HDO8aVw91rh7rXDee+QI+MD3OeY3jmQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Test in Cypress\"\n        title=\"Example of Tests running in Cypress. On the left you see the test and can also jump forth and back between states, on the right you see the rendered HTML page\"\n        src=\"/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/f058b/cypress.png\"\n        srcset=\"/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/c26ae/cypress.png 158w,\n/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/6bdcf/cypress.png 315w,\n/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/f058b/cypress.png 630w,\n/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/40601/cypress.png 945w,\n/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/78612/cypress.png 1260w,\n/static/e91ebe3f4fb4ad6ce6b58ae82f8e00b7/058d6/cypress.png 2277w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Example of Tests running in Cypress. On the left you see the test and can also jump forth and back between states, on the right you see the rendered HTML page</figcaption>\n  </figure></p>\n<p>All of the tests are actually integrated in the SkoHub Vocabs CI pipeline and run before a new docker image gets build.</p>","frontmatter":{"title":"Moving to test-driven development and updating existing tests","date":"February 09, 2023","authors":[{"lastname":"Rörtgen","firstname":"Steffen"}],"description":null}},"previous":{"fields":{"slug":"/2022-12-19-workshop-summary/"},"frontmatter":{"title":"Notes from the November workshop"}},"next":{"fields":{"slug":"/2023-11-22-shacl-shape/"},"frontmatter":{"title":"Development of SKOS SHACL shape"}}},"pageContext":{"id":"a9ca1438-2e05-5355-8e06-72fe48377acc","previousPostId":"c45557b7-0901-5b47-8e00-548ea748b6f9","nextPostId":"e19fa987-ceb2-54a5-b888-63169daac7e7"}},"staticQueryHashes":["1878297489","2734362168","3000541721"],"slicesMap":{}}